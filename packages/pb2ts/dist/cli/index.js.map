{"version":3,"sources":["../../node_modules/tsup/assets/esm_shims.js","../../src/cli/index.ts","../../src/config/loadConfig.ts","../../src/config/defaults.ts","../../src/config/validate.ts","../../package.json","../../src/parser/runParser.ts","../../src/generator/service.ts","../../src/generator/index.ts"],"sourcesContent":["// Shim globals in esm bundle\nimport path from 'node:path'\nimport { fileURLToPath } from 'node:url'\n\nconst getFilename = () => fileURLToPath(import.meta.url)\nconst getDirname = () => path.dirname(getFilename())\n\nexport const __dirname = /* @__PURE__ */ getDirname()\nexport const __filename = /* @__PURE__ */ getFilename()\n","import cac from 'cac'\nimport pc from 'picocolors'\nimport { loadConfig } from '../config/loadConfig'\nimport { version } from '../../package.json'\nimport { generate } from '../generator'\n\nconst cli = cac('pb2ts')\n\ncli\n    .command(\n        'gen',\n        'Generate TypeScript clients from proto files',\n    )\n    .option('--proto <dir>', 'Proto root directory')\n    .option('--out <dir>', 'Output directory')\n    .option('-c, --config <file>', 'Use specific config file')\n    .action(async (options) => {\n        try {\n            console.log(pc.cyan(`\\n  pb2ts v${version}\\n`))\n\n            const overrides = {\n                proto: options.proto ? { \n                    root: options.proto,\n                    include: [],\n                    exclude: []\n                } : undefined,\n                output: options.out ? { dir: options.out } : undefined,\n            }\n\n            const config = loadConfig(process.cwd(), {\n                configFile: options.config,\n                overrides,\n            })\n\n            console.log(pc.green('  Config loaded!'))\n            console.log(pc.dim('  Parsing proto files...'))\n\n            await generate(config)\n\n            console.log(pc.green('\\n  Done!\\n'))\n        } catch (error) {\n            console.error(\n                pc.red(\n                    `\\n  ${error instanceof Error ? error.message : String(error)}\\n`,\n                ),\n            )\n            process.exit(1)\n        }\n    })\n\ncli.help()\ncli.version(version)\n\ncli.parse()","import fs from 'fs'\r\nimport path from 'path'\r\nimport jiti from 'jiti'\r\n\r\nimport type { Pb2tsConfig } from './types'\r\nimport { defaultConfig } from './defaults'\r\nimport { validateConfig } from './validate'\r\n\r\nexport interface LoadConfigOptions {\r\n    /**\r\n     * CLI 参数覆盖\r\n     * 优先级最高\r\n     */\r\n    overrides?: Partial<Pb2tsConfig>\r\n\r\n    /**\r\n     * 指定 config 文件路径\r\n     * 默认自动查找\r\n     */\r\n    configFile?: string\r\n}\r\n\r\nconst CONFIG_FILES = [\r\n    'pb2ts.config.ts',\r\n]\r\n\r\nexport function loadConfig(\r\n    cwd: string = process.cwd(),\r\n    options: LoadConfigOptions = {},\r\n): Pb2tsConfig {\r\n    const configPath = options.configFile\r\n        ? path.resolve(cwd, options.configFile)\r\n        : findConfigFile(cwd)\r\n\r\n    let userConfig: Partial<Pb2tsConfig> = {}\r\n\r\n    if (configPath) {\r\n        const load = jiti(__filename, {\r\n            interopDefault: true,\r\n            esmResolve: true,\r\n        })\r\n\r\n        try {\r\n            userConfig = load(configPath)\r\n        } catch (err) {\r\n            throw new Error(\r\n                `Failed to load config file: ${configPath}\\n` +\r\n                (err instanceof Error ? err.message : String(err)),\r\n            )\r\n        }\r\n    }\r\n\r\n    // 合并顺序：default -> user -> cli overrides\r\n    const merged = mergeConfig(\r\n        defaultConfig,\r\n        userConfig,\r\n        options.overrides,\r\n    )\r\n\r\n    validateConfig(merged)\r\n\r\n    return freezeConfig(merged)\r\n}\r\n\r\n/**\r\n * 在 cwd 中查找 config 文件\r\n */\r\nfunction findConfigFile(cwd: string): string | undefined {\r\n    for (const name of CONFIG_FILES) {\r\n        const file = path.join(cwd, name)\r\n        if (fs.existsSync(file)) {\r\n            return file\r\n        }\r\n    }\r\n    return undefined\r\n}\r\n\r\n/**\r\n * 明确的、可控的 merge 逻辑\r\n * - object: shallow merge\r\n * - array: override\r\n * - primitive: override\r\n */\r\nfunction mergeConfig(\r\n    base: Pb2tsConfig,\r\n    user?: Partial<Pb2tsConfig>,\r\n    overrides?: Partial<Pb2tsConfig>,\r\n): Pb2tsConfig {\r\n    const merged: Pb2tsConfig = {\r\n        ...base,\r\n        ...user,\r\n        proto: {\r\n            ...base.proto,\r\n            ...user?.proto,\r\n        },\r\n        output: {\r\n            ...base.output,\r\n            ...user?.output,\r\n        },\r\n    }\r\n\r\n    if (overrides) {\r\n        if (overrides.proto) {\r\n            merged.proto = { ...merged.proto, ...overrides.proto }\r\n        }\r\n        if (overrides.output) {\r\n            merged.output = { ...merged.output, ...overrides.output }\r\n        }\r\n    }\r\n\r\n    return merged\r\n}\r\n\r\n/**\r\n * 防止后续阶段（generator / plugin）意外修改 config\r\n */\r\nfunction freezeConfig<T>(config: T): T {\r\n    Object.freeze(config)\r\n\r\n    for (const value of Object.values(config as Record<string, unknown>)) {\r\n        if (value && typeof value === 'object') {\r\n            Object.freeze(value)\r\n        }\r\n    }\r\n\r\n    return config\r\n}\r\n","import type { Pb2tsConfig } from './types'\nimport type { RPC } from '../parser/types'\n\nexport const defaultConfig: Pb2tsConfig = {\n    proto: {\n        root: './',\n        include: [],\n        exclude: ['node_modules', 'dist'],\n    },\n    output: {\n        dir: 'src/api',\n        imports: ['import { fetch } from \"fetch\"'],\n        defaultFuncTemplate : defaultFuncTemplate,\n    },\n}\n\nfunction defaultFuncTemplate(r:RPC) {\n    if (r.leadingComments == \"\") {\n        r.leadingComments = r.name\n    }\n    return `\n    // ${ r.leadingComments } ${r.name}\n    `\n}","import type { Pb2tsConfig } from './types'\n\nexport function validateConfig(config: Pb2tsConfig): void {\n    if (!config.proto?.root) {\n        throw new Error('config.proto.root is required')\n    }\n\n    if (!config.output?.dir) {\n        throw new Error('config.output.dir is required')\n    }\n}\n","{\n  \"name\": \"pb2ts\",\n  \"version\": \"0.1.0\",\n  \"description\": \"Generate TypeScript HTTP clients from protobuf with google.api.http\",\n  \"author\": \"your-name\",\n  \"license\": \"MIT\",\n  \"type\": \"module\",\n  \"bin\": {\n    \"pb2ts\": \"./dist/cli/index.js\"\n  },\n  \"exports\": {\n    \".\": {\n      \"types\": \"./dist/index.d.ts\",\n      \"import\": \"./dist/index.js\"\n    }\n  },\n  \"files\": [\n    \"dist\",\n    \"bin\"\n  ],\n  \"scripts\": {\n    \"build\": \"tsup\",\n    \"dev\": \"tsup --watch\",\n    \"typecheck\": \"tsc -p tsconfig.json --noEmit\",\n    \"prepublishOnly\": \"npm run build\",\n    \"test:gen\": \"node ./dist/cli/index.js gen --proto ../../test/test_proto --out ../../test/api\"\n  },\n  \"dependencies\": {\n    \"cac\": \"^6.7.14\",\n    \"fs-extra\": \"^11.2.0\",\n    \"jiti\": \"^1.21.0\",\n    \"picocolors\": \"^1.0.0\"\n  },\n  \"devDependencies\": {\n    \"@types/fs-extra\": \"^11.0.4\",\n    \"@types/node\": \"^20.11.5\",\n    \"tsup\": \"^8.0.1\",\n    \"typescript\": \"^5.3.3\"\n  },\n  \"engines\": {\n    \"node\": \">=18\"\n  }\n}\n","import { spawn } from 'child_process'\nimport path from 'path'\nimport fs from 'fs'\nimport type { ParseResult } from './types'\nimport type {Pb2tsConfig} from \"../config/types\";\n\nexport async function runParser(config: Pb2tsConfig): Promise<ParseResult> {\n    const packageRoot = path.resolve(__dirname, '..', '..')\n\n    const possiblePaths = [\n        path.resolve(packageRoot, 'bin/pb2ts-parser.exe'),\n        path.resolve(packageRoot, 'bin/pb2ts-parser'),\n        path.resolve(packageRoot, '../../bin/pb2ts-parser.exe'),\n        path.resolve(packageRoot, '../../bin/pb2ts-parser'),\n        path.resolve(process.cwd(), 'bin/pb2ts-parser.exe'),\n        path.resolve(process.cwd(), 'bin/pb2ts-parser'),\n        'pb2ts-parser',\n    ]\n\n    let binPath = ''\n    for (const p of possiblePaths) {\n        if (p === 'pb2ts-parser') {\n            binPath = p\n            break\n        }\n        if (fs.existsSync(p)) {\n            binPath = p\n            break\n        }\n    }\n\n    if (!binPath) {\n        throw new Error('Could not find pb2ts-parser binary')\n    }\n\n    const args = ['--proto', config.proto.root]\n    if (config.proto.include.length > 0) {\n        args.push('--imports', config.proto.include.join(','))\n    }\n\n    if (config.proto.exclude.length > 0) {\n        args.push('--exclude', config.proto.exclude.join(','))\n    }\n\n    return new Promise((resolve, reject) => {\n        const child = spawn(binPath, args)\n\n        let stdout = ''\n        let stderr = ''\n\n        child.stdout.on('data', (data) => {\n            stdout += data.toString()\n        })\n\n        child.stderr.on('data', (data) => {\n            stderr += data.toString()\n        })\n\n        child.on('close', (code) => {\n            if (code !== 0) {\n                reject(new Error(`Parser exited with code ${code}: ${stderr}`))\n                return\n            }\n\n            try {\n                const result = JSON.parse(stdout) as ParseResult\n                resolve(result)\n            } catch (err) {\n                reject(new Error(`Failed to parse JSON output: ${err}\\nOutput: ${stdout}`))\n            }\n        })\n\n        child.on('error', (err) => {\n            reject(err)\n        })\n    })\n}\n","import type { Service,ParseResult,Enum,Message,Field,RPC } from '../parser/types'\nimport type { Pb2tsConfig } from '../config/types'\nimport path from 'path'\nimport fs from 'fs'\n\n// ===== 代码生成器配置 =====\ninterface GeneratorConfig {\n    outputDir: string;\n    customDir?: string; // 用户自定义代码目录\n}\n\n// ===== 核心生成器类 =====\nexport class ProtoToTsGenerator {\n    private config: Pb2tsConfig;\n    private generatorConfig: GeneratorConfig;\n\n    constructor(config: Pb2tsConfig) {\n        this.config = config;\n        this.generatorConfig = {\n            outputDir: path.join(config.output.dir, 'generated'),\n        };\n    }\n\n    /**\n     * 生成所有服务的代码\n     */\n    generate(services: ParseResult): void {\n        for (const service of services) {\n            this.generateService(service);\n        }\n    }\n\n    /**\n     * 为单个服务生成代码\n     */\n    private generateService(service: Service): void {\n        const serviceDir = path.join(this.generatorConfig.outputDir,service.name);\n\n        // 确保目录存在\n        this.ensureDir(serviceDir);\n\n        // 1. 生成 types.ts（完全覆盖）\n        const typesContent = this.generateTypes(service);\n        this.writeFile(\n            path.join(serviceDir, `${service.name}.types.ts`),\n            typesContent\n        );\n\n        // 2. 生成 index.ts（完全覆盖）\n        const indexContent = this.generateIndex(service);\n        this.writeFile(\n            path.join(serviceDir, `${service.name}.index.ts`),\n            indexContent\n        );\n\n        // 3. 初始化用户扩展文件（仅创建，不覆盖）\n        this.initializeCustomFile(service,serviceDir);\n    }\n\n    /**\n     * 生成 types.ts 内容\n     */\n    private generateTypes(service: Service): string {\n        const parts: string[] = [];\n\n        // 文件头部警告\n        parts.push(this.generateHeader());\n\n        // 生成 Enums\n        for (const enumDef of service.enums) {\n            parts.push(this.generateEnum(enumDef));\n        }\n\n        // 生成 Messages (Interfaces)\n        for (const message of service.message) {\n            parts.push(this.generateMessage(message));\n        }\n\n        return parts.join('\\n\\n');\n    }\n\n    /**\n     * 生成 index.ts 内容\n     */\n    private generateIndex(service: Service): string {\n        const parts: string[] = [];\n\n        parts.push(this.generateHeader());\n\n        // 导入类型\n        parts.push(`import * as Types from './${service.name}.types';`);\n        parts.push('');\n\n        // 导出类型\n        parts.push(`export { Types };`);\n        parts.push('');\n\n        // 生成服务类\n        parts.push(this.generateServiceClass(service));\n\n        return parts.join('\\n');\n    }\n\n    /**\n     * 生成文件头部注释\n     */\n    private generateHeader(): string {\n        return `/**\n * ⚠️ AUTO-GENERATED CODE - DO NOT EDIT\n * \n * This file is automatically generated from Protocol Buffer definitions.\n * Any manual changes will be overwritten on the next generation.\n * \n * Generated at: ${new Date().toISOString()}\n */`;\n    }\n\n    /**\n     * 生成 Enum\n     */\n    private generateEnum(enumDef: Enum): string {\n        const parts: string[] = [];\n\n        // 添加注释\n        if (enumDef.leadingComments) {\n            parts.push(this.formatComment(enumDef.leadingComments));\n        }\n\n        parts.push(`export enum ${enumDef.name} {`);\n\n        for (const item of enumDef.enumItems) {\n            if (item.leadingComments) {\n                parts.push(`  ${this.formatComment(item.leadingComments, 2)}`);\n            }\n            parts.push(`  ${item.key} = ${item.value},`);\n        }\n\n        parts.push('}');\n\n        return parts.join('\\n');\n    }\n\n    /**\n     * 生成 Message (Interface)\n     */\n    private generateMessage(message: Message): string {\n        const parts: string[] = [];\n\n        // 添加注释\n        if (message.leadingComments) {\n            parts.push(this.formatComment(message.leadingComments));\n        }\n\n        parts.push(`export interface ${message.name} {`);\n\n        for (const field of message.fields) {\n            if (field.leadingComments) {\n                parts.push(`  ${this.formatComment(field.leadingComments, 2)}`);\n            }\n\n            const fieldType = this.getFieldType(field);\n            parts.push(`  ${field.name}: ${fieldType};`);\n        }\n\n        parts.push('}');\n\n        return parts.join('\\n');\n    }\n\n    /**\n     * 获取字段类型\n     */\n    private getFieldType(field: Field): string {\n        let baseType: string;\n\n        if (field.isMap) {\n            // Map 类型\n            const keyType = this.mapProtoTypeToTs(field.mapKey);\n            const valueType = this.mapProtoTypeToTs(field.mapValue);\n            baseType = `Record<${keyType}, ${valueType}>`;\n        } else if (field.typeName) {\n            // 自定义类型（Message 或 Enum）\n            baseType = field.typeName;\n        } else {\n            // 基础类型\n            baseType = this.mapProtoTypeToTs(field.type);\n        }\n\n        // 处理 repeated (数组)\n        if (field.isRepeated) {\n            return `${baseType}[]`;\n        }\n\n        return baseType;\n    }\n\n    /**\n     * Proto 类型到 TS 类型映射\n     */\n    private mapProtoTypeToTs(protoType: string): string {\n        const typeMap: Record<string, string> = {\n            'int32': 'number',\n            'int64': 'number',\n            'uint32': 'number',\n            'uint64': 'number',\n            'sint32': 'number',\n            'sint64': 'number',\n            'fixed32': 'number',\n            'fixed64': 'number',\n            'sfixed32': 'number',\n            'sfixed64': 'number',\n            'float': 'number',\n            'double': 'number',\n            'bool': 'boolean',\n            'string': 'string',\n            'bytes': 'Uint8Array',\n        };\n\n        return typeMap[protoType] || protoType;\n    }\n\n    /**\n     * 生成服务类\n     */\n    private generateServiceClass(service: Service): string {\n        const parts: string[] = [];\n\n        if (service.leadingComments) {\n            parts.push(this.formatComment(service.leadingComments));\n        }\n\n        parts.push(`export class ${service.name}Service {`);\n        parts.push('  private baseUrl: string;');\n        parts.push('');\n        parts.push('  constructor(baseUrl: string) {');\n        parts.push('    this.baseUrl = baseUrl;');\n        parts.push('  }');\n\n        // 生成 RPC 方法\n        for (const rpc of service.rpc) {\n            parts.push('');\n            parts.push(this.generateRpcMethod(rpc));\n        }\n\n        parts.push('}');\n\n        return parts.join('\\n');\n    }\n\n    /**\n     * 生成 RPC 方法\n     */\n    private generateRpcMethod(rpc: RPC): string {\n        const parts: string[] = [];\n\n        if (rpc.leadingComments) {\n            parts.push(`  ${this.formatComment(rpc.leadingComments, 2)}`);\n        }\n\n        const methodName = this.toCamelCase(rpc.name);\n        parts.push(`  async ${methodName}(request: Types.${rpc.request}): Promise<Types.${rpc.resp}> {`);\n        parts.push(`    const response = await fetch(\\`\\${this.baseUrl}${rpc.path}\\`, {`);\n        parts.push(`      method: '${rpc.method.toUpperCase()}',`);\n        parts.push(`      headers: { 'Content-Type': 'application/json' },`);\n        parts.push(`      body: JSON.stringify(request),`);\n        parts.push(`    });`);\n        parts.push('');\n        parts.push('    if (!response.ok) {');\n        parts.push(`      throw new Error(\\`${rpc.name} failed: \\${response.statusText}\\`);`);\n        parts.push('    }');\n        parts.push('');\n        parts.push('    return response.json();');\n        parts.push('  }');\n\n        return parts.join('\\n');\n    }\n\n    /**\n     * 格式化注释\n     */\n    private formatComment(comment: string, indent: number = 0): string {\n        const indentStr = ' '.repeat(indent);\n        const lines = comment.trim().split('\\n');\n\n        if (lines.length === 1) {\n            return `${indentStr}/** ${lines[0]} */`;\n        }\n\n        return [\n            `${indentStr}/**`,\n            ...lines.map(line => `${indentStr} * ${line}`),\n            `${indentStr} */`\n        ].join('\\n');\n    }\n\n    /**\n     * 转换为驼峰命名\n     */\n    private toCamelCase(str: string): string {\n        return str.replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n    }\n\n    /**\n     * 初始化用户自定义文件（仅在不存在时创建）\n     */\n    private initializeCustomFile(service: Service,serviceDir:string): void {\n        const customFilePath = path.join(serviceDir, `${service.name}.extensions.ts`);\n        // 只在文件不存在时创建\n        if (!fs.existsSync(customFilePath)) {\n            const template = this.generateExtensionTemplate(service);\n            this.writeFile(customFilePath, template);\n        }\n    }\n\n    /**\n     * 生成扩展文件模板\n     */\n    private generateExtensionTemplate(service: Service): string {\n        return `/**\n * User custom extensions for ${service.name}\n * \n * This file is for your custom code and will NOT be overwritten.\n * Import generated types from: ../${service.name}/${service.name}.types\n */\n\nimport { ${service.name}Service, Types } from '../generated/${service.name}/${service.name}.index';\n\n// Example: Extend the generated service\nexport class ${service.name}ServiceExtended extends ${service.name}Service {\n  // Add your custom methods here\n  \n  // Example:\n  // async customMethod(data: Types.SomeMessage): Promise<void> {\n  //   // Your custom logic\n  // }\n}\n\n// Example: Helper functions\n// export function validate${service.name}(data: Types.SomeMessage): boolean {\n//   // Your validation logic\n//   return true;\n// }\n`;\n    }\n\n    /**\n     * 确保目录存在\n     */\n    private ensureDir(dir: string): void {\n        if (!fs.existsSync(dir)) {\n            fs.mkdirSync(dir, { recursive: true });\n        }\n    }\n\n    /**\n     * 写入文件\n     */\n    private writeFile(filePath: string, content: string): void {\n        fs.writeFileSync(filePath, content, 'utf-8');\n        console.log(`✅ Generated: ${filePath}`);\n    }\n}\n","import { runParser } from '../parser/runParser'\nimport type { Pb2tsConfig } from '../config/types'\nimport { ProtoToTsGenerator } from './service'\n\nexport async function generate(config: Pb2tsConfig) {\n    const services = await runParser(config)\n\n    console.log('Generating...')\n\n    console.log(services)\n\n    const generator = new ProtoToTsGenerator(config);\n\n    generator.generate(services);\n}"],"mappings":"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","names":["path","path","path","fs","path","fs"]}